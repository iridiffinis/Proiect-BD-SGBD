/*DROP TABLE REGIUNI CASCADE CONSTRAINTS;
DROP TABLE CLIENTI CASCADE CONSTRAINTS;

CREATE TABLE REGIUNI_BD
(ID_REGIUNE NUMBER(6) CONSTRAINT PK_REGIUNI PRIMARY KEY,
 DENUMIRE_REGIUNE VARCHAR2(30)
);

ALTER TABLE REGIUNI_BD RENAME TO REGIUNI;
ALTER TABLE REGIUNI ADD CONSTRAINT ID_REGIUNE_NN
CHECK("ID_REGIUNE" IS NOT NULL);

CREATE TABLE CLIENTI
(ID_CLIENT NUMBER(6) CONSTRAINT PK_CLIENTI PRIMARY KEY,
 PRENUME_CLIENT VARCHAR2(20),
 NUME_CLIENT VARCHAR2(20),
 TELEFON VARCHAR2(20),
 EMAIL_CLIENT VARCHAR2(30)
);

ALTER TABLE CLIENTI_BD RENAME TO CLIENTI;

ALTER TABLE CLIENTI
ADD CONSTRAINT FK_CLIENTI FOREIGN KEY (ID_REGIUNE) 
REFERENCES REGIUNI(ID_REGIUNE);*/
--------------------------------------------------------------------------------------------------

CREATE TABLE REGIUNI
(ID_REGIUNE NUMBER(6) CONSTRAINT PK_REGIUNI PRIMARY KEY,
 DENUMIRE_REGIUNE VARCHAR2(30) NOT NULL
);

CREATE TABLE CLIENTI
(ID_CLIENT NUMBER(6) CONSTRAINT PK_CLIENTI PRIMARY KEY,
 PRENUME_CLIENT VARCHAR2(20) NOT NULL,
 NUME_CLIENT VARCHAR2(20) NOT NULL,
 TELEFON VARCHAR2(20),
 EMAIL_CLIENT VARCHAR2(30),
 ID_REGIUNE NUMBER(6)
);

ALTER TABLE CLIENTI
ADD CONSTRAINT FK_CLIENTI FOREIGN KEY (ID_REGIUNE) 
REFERENCES REGIUNI(ID_REGIUNE);

CREATE TABLE FURNIZORI
(ID_FURNIZOR NUMBER(6) CONSTRAINT PK_FURNIZOR PRIMARY KEY,
 DENUMIRE_FURNIZOR VARCHAR2(50) NOT NULL,
 ADRESA_FURNIZOR VARCHAR2(50) NOT NULL,
 TELEFON_FURNIZOR VARCHAR2(20),
 EMAIL_FURNIZOR VARCHAR2(30),
 ID_REGIUNE NUMBER(6),
 CONSTRAINT FK_FURNIZORI FOREIGN KEY (ID_REGIUNE) REFERENCES REGIUNI(ID_REGIUNE)
);

CREATE TABLE COMENZI
(ID_COMANDA NUMBER(6) CONSTRAINT PK_COMENZI PRIMARY KEY,
 DATA DATE DEFAULT SYSDATE,
 DESCRIERE_COMANDA VARCHAR2(200),
 STARE_COMANDA NUMBER(2),
 ID_FURNIZOR NUMBER(6),
 ID_CLIENT NUMBER(6),
 CONSTRAINT FK_FURNIZOR_COMENZI FOREIGN KEY (ID_FURNIZOR) REFERENCES FURNIZORI(ID_FURNIZOR),
 CONSTRAINT FK_CLIENT_COMENZI FOREIGN KEY (ID_CLIENT) REFERENCES CLIENTI(ID_CLIENT)
);

CREATE TABLE SORTIMENTE_LEMN
(ID_LEMN NUMBER(6) CONSTRAINT PK_LEMN PRIMARY KEY,
 DENUMIRE_LEMN VARCHAR2(50) NOT NULL,
 DESCRIERE_LEMN VARCHAR2(2000),
 CATEGORIE VARCHAR2(50),
 PRET NUMBER(8,2),
 ID_REGIUNE NUMBER(6),
 CONSTRAINT FK_LEMN FOREIGN KEY (ID_REGIUNE) REFERENCES REGIUNI(ID_REGIUNE)
);

ALTER TABLE SORTIMENTE_LEMN ADD CONSTRAINT LEMN_PRET_MIN
CHECK(PRET>0);

CREATE TABLE TRANSPORTURI
(ID_COMANDA NUMBER(6) NOT NULL,
 ID_LEMN NUMBER(6) NOT NULL,
 PRET_TOTAL NUMBER(8,2),
 CANTITATE NUMBER(12)
);

ALTER TABLE TRANSPORTURI ADD CONSTRAINT PK_TRANSPORTURI PRIMARY KEY (ID_COMANDA, ID_LEMN);

ALTER TABLE TRANSPORTURI ADD CONSTRAINT FK_TRANS_LEMN FOREIGN KEY (ID_LEMN)
REFERENCES SORTIMENTE_LEMN(ID_LEMN);

ALTER TABLE TRANSPORTURI ADD CONSTRAINT FK_TANS_COMANDA FOREIGN KEY (ID_COMANDA)
REFERENCES COMENZI(ID_COMANDA) ON DELETE CASCADE;

ALTER TABLE TRANSPORTURI ADD CONSTRAINT CK_PRET
CHECK(PRET_TOTAL>0);

ALTER TABLE TRANSPORTURI ADD CONSTRAINT CK_CANTITATE
CHECK(CANTITATE>0);

ALTER TABLE TRANSPORTURI MODIFY CANTITATE NUMBER(12,2);

----------------------
DESC REGIUNI;
DESC CLIENTI;
DESC FURNIZORI;
DESC COMENZI;
DESC SORTIMENTE_LEMN;
DESC TRANSPORTURI;

INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (1,'Bihor');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (2,'Bistrita-Nasaud');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (3,'Cluj');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (4,'Maramures');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (5,'Satu Mare');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (6,'Salaj');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (7,'Alba');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (8,'Brasov');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (9,'Covasna');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (10,'Harghita');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (11,'Mures');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (12,'Sibiu');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (13,'Bacau');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (14,'Botosani');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (15,'Iasi');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (16,'Neamt');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (17,'Suceava');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (18,'Vaslui');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (19,'Braila');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (20,'Buzau');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (21,'Constanta');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (22,'Galati');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (23,'Tulcea');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (24,'Vrancea');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (25,'Arges');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (26,'Calarasi');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (27,'Dambovita');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (28,'Giurgiu');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (29,'Ialomita');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (30,'Prahova');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (31,'Teleorman');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (32,'Ilfov');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (33,'Municipiul Bucuresti');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (34,'Dolj');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (35,'Gorj');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (36,'Mehedinti');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (37,'Olt');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (38,'Valcea');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (39,'Arad');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (40,'Caras-Severin');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (41,'Hunedoara');
INSERT INTO REGIUNI (ID_REGIUNE, DENUMIRE_REGIUNE) VALUES (42,'Timis');

SELECT * FROM REGIUNI;

INSERT INTO CLIENTI (ID_CLIENT, PRENUME_CLIENT, NUME_CLIENT, TELEFON, EMAIL_CLIENT, ID_REGIUNE)
VALUES (1, 'Irina', 'Gugiuman', '1234567890', 'gugiumanirina20@stud.ase.ro',33);
INSERT INTO CLIENTI (ID_CLIENT, PRENUME_CLIENT, NUME_CLIENT, ID_REGIUNE)
VALUES(2,'Cosmin','Popescu',32);
INSERT INTO CLIENTI (ID_CLIENT, PRENUME_CLIENT, NUME_CLIENT, ID_REGIUNE)
VALUES(3,'Maria','Constantinescu',8);
INSERT INTO CLIENTI (ID_CLIENT, PRENUME_CLIENT, NUME_CLIENT, ID_REGIUNE)
VALUES(4,'Elena','Rosu',39);
INSERT INTO CLIENTI (ID_CLIENT, PRENUME_CLIENT, NUME_CLIENT, ID_REGIUNE)
VALUES(5,'Cristian','Iordache',20);

SELECT * FROM CLIENTI;

UPDATE CLIENTI SET TELEFON='4568521563' WHERE ID_CLIENT=2;

INSERT INTO FURNIZORI (ID_FURNIZOR,DENUMIRE_FURNIZOR,ADRESA_FURNIZOR,ID_REGIUNE)
VALUES (1,'Lemn Prod','Domnesti',25);
INSERT INTO FURNIZORI (ID_FURNIZOR,DENUMIRE_FURNIZOR,ADRESA_FURNIZOR,ID_REGIUNE)
VALUES (2,'Silva Prod','Bicaz',16);
INSERT INTO FURNIZORI (ID_FURNIZOR,DENUMIRE_FURNIZOR,ADRESA_FURNIZOR,ID_REGIUNE)
VALUES (3,'Valdo Forest','Dumitresti',24);
INSERT INTO FURNIZORI (ID_FURNIZOR,DENUMIRE_FURNIZOR,ADRESA_FURNIZOR,ID_REGIUNE)
VALUES (4,'Diana Forest','Arpas',12);
INSERT INTO FURNIZORI (ID_FURNIZOR,DENUMIRE_FURNIZOR,ADRESA_FURNIZOR,ID_REGIUNE)
VALUES (5,'Forest Grup','Fetesti',29);
INSERT INTO FURNIZORI (ID_FURNIZOR,DENUMIRE_FURNIZOR,ADRESA_FURNIZOR,ID_REGIUNE)
VALUES (6,'Foredist','Bran',8);

SELECT * FROM FURNIZORI;

DELETE FROM FURNIZORI WHERE ID_FURNIZOR=6;

INSERT INTO COMENZI (ID_COMANDA, DATA, ID_FURNIZOR, ID_CLIENT)
VALUES (1,TO_DATE('30.11.2021','DD.MM.YYYY'),1,2);
INSERT INTO COMENZI (ID_COMANDA, DATA, ID_FURNIZOR, ID_CLIENT)
VALUES (2,TO_DATE('07.10.2021','DD.MM.YYYY'),1,3);
INSERT INTO COMENZI (ID_COMANDA, DATA, ID_FURNIZOR, ID_CLIENT)
VALUES (3,TO_DATE('12.12.2021','DD.MM.YYYY'),2,2);
INSERT INTO COMENZI (ID_COMANDA, DATA, ID_FURNIZOR, ID_CLIENT)
VALUES (4,TO_DATE('27.09.2021','DD.MM.YYYY'),2,4);
INSERT INTO COMENZI (ID_COMANDA, DATA, ID_FURNIZOR, ID_CLIENT)
VALUES (5,TO_DATE('04.01.2022','DD.MM.YYYY'),3,4);
INSERT INTO COMENZI (ID_COMANDA, DATA, ID_FURNIZOR, ID_CLIENT)
VALUES (6,TO_DATE('07.01.2022','DD.MM.YYYY'),5,3);

SELECT * FROM COMENZI;

UPDATE COMENZI SET STARE_COMANDA=0 WHERE ID_COMANDA IN(1,2,3,4,5,6);

INSERT INTO SORTIMENTE_LEMN (ID_LEMN, DENUMIRE_LEMN, PRET, ID_REGIUNE)
VALUES (1,'Carpen',500,12);
INSERT INTO SORTIMENTE_LEMN (ID_LEMN, DENUMIRE_LEMN, PRET, ID_REGIUNE)
VALUES (2,'Fag',500,16);
INSERT INTO SORTIMENTE_LEMN (ID_LEMN, DENUMIRE_LEMN, PRET, ID_REGIUNE)
VALUES (3,'Plop',300,29);
INSERT INTO SORTIMENTE_LEMN (ID_LEMN, DENUMIRE_LEMN, PRET, ID_REGIUNE)
VALUES (4,'Salcie',300,29);
INSERT INTO SORTIMENTE_LEMN (ID_LEMN, DENUMIRE_LEMN, PRET, ID_REGIUNE)
VALUES (5,'Stejar',500,25);
INSERT INTO SORTIMENTE_LEMN (ID_LEMN, DENUMIRE_LEMN, PRET, ID_REGIUNE)
VALUES (6,'Frasin',500,13);
INSERT INTO SORTIMENTE_LEMN (ID_LEMN, DENUMIRE_LEMN, PRET, ID_REGIUNE)
VALUES (7,'Salcam',700,25);

SELECT * FROM SORTIMENTE_LEMN;

--LEMN DE FOC SI LEMN DE LUCRU

UPDATE SORTIMENTE_LEMN SET CATEGORIE = 'lemn de foc' WHERE ID_LEMN IN (1,2,3,4,5,6,7);

INSERT INTO TRANSPORTURI (ID_COMANDA, ID_LEMN, PRET_TOTAL, CANTITATE)
VALUES (1,3,1500,50);
INSERT INTO TRANSPORTURI (ID_COMANDA, ID_LEMN, PRET_TOTAL, CANTITATE)
VALUES (1,2,12500,25);
INSERT INTO TRANSPORTURI (ID_COMANDA, ID_LEMN, PRET_TOTAL, CANTITATE)
VALUES (2,1,5000,10);
INSERT INTO TRANSPORTURI (ID_COMANDA, ID_LEMN, PRET_TOTAL, CANTITATE)
VALUES (2,7,3850,5.5);
INSERT INTO TRANSPORTURI (ID_COMANDA, ID_LEMN, PRET_TOTAL, CANTITATE)
VALUES (3,5,5000,10);
INSERT INTO TRANSPORTURI (ID_COMANDA, ID_LEMN, PRET_TOTAL, CANTITATE)
VALUES (4,4,7500,25);
INSERT INTO TRANSPORTURI (ID_COMANDA, ID_LEMN, PRET_TOTAL, CANTITATE)
VALUES (5,2,7500,15);
INSERT INTO TRANSPORTURI (ID_COMANDA, ID_LEMN, PRET_TOTAL, CANTITATE)
VALUES (6,3,7650,25.5);

SELECT * FROM TRANSPORTURI;

-------------------------
--1 SA SE AFISEZE PENTRU FIECARE SORTIMENT DE LEMN CATEGORIA DE PRET DIN CARE FACE PARTE
SELECT ID_LEMN, DENUMIRE_LEMN, PRET,
CASE WHEN PRET BETWEEN 200 AND 300 THEN 'PRET MIC'
     WHEN PRET BETWEEN 301 AND 600 THEN 'PRET MEDIU'
     WHEN PRET >600 THEN 'PRET MARE'
     ELSE 'PRET ERONAT/LIPSA' END PRET_CASE
FROM SORTIMENTE_LEMN ORDER BY PRET;

--2 SA SE MODIFICE STAREA COMENZII IN 1 PENTRU COMENZILE DIN LUNA SEPTEMBRIE
UPDATE COMENZI SET STARE_COMANDA=1 WHERE TO_CHAR(DATA,'MM')='09';

--3 SA SE MODIFICE STAREA COMENZII IN 2 PENTRU COMENZILE DIN LUNILE OCTOMBRIE SI NOIEMBRIE
UPDATE COMENZI SET STARE_COMANDA=2 WHERE TO_CHAR(DATA,'MM')='10' OR TO_CHAR(DATA,'MM')='11';

--4 SA SE MODIFICE STAREA COMENZII IN 3 PENTRU COMENZILE DIN LUNA DECEMBRIE
UPDATE COMENZI SET STARE_COMANDA=3 WHERE TO_CHAR(DATA,'MM')='12';

--5 SA SE MODIFICE SATREA COMENZII IN 4 PENTRU COMENZILE DIN ANUL CURENT
UPDATE COMENZI SET STARE_COMANDA=4 WHERE EXTRACT(YEAR FROM DATA)=EXTRACT(YEAR FROM SYSDATE);

--6 SA SE AFISEZE STAREA COMENZILOR
SELECT ID_COMANDA, DATA, STARE_COMANDA,
DECODE(STARE_COMANDA, 0,'PLASATA',1,'TERMINATA',2,'LIVRATA',3,'ACHITATA',4,'IN CURS DE ACHITARE') DECODE_STARE
FROM COMENZI;

--7 SA SE AFISEZE FURNIZORII SI REGIUNEA DIN CARE FAC PARTE
SELECT ID_FURNIZOR, DENUMIRE_FURNIZOR, DENUMIRE_REGIUNE 
FROM FURNIZORI F JOIN REGIUNI R
ON F.ID_REGIUNE=R.ID_REGIUNE;

--8 SA SE AFISEZE VALOAREA TOTALA A COMENZILOR > 7000
SELECT ID_COMANDA, SUM(PRET_TOTAL) VAL FROM TRANSPORTURI
GROUP BY ID_COMANDA
HAVING SUM(PRET_TOTAL)>7000;

SELECT SUM(PRET_TOTAL) FROM TRANSPORTURI;

--9 SA SE AFISEZE NUMELE FURNIZORULUI CLIENTULUI CARE ESTE DIN REGIUNEA BRASOV
SELECT DENUMIRE_FURNIZOR FROM FURNIZORI WHERE ID_FURNIZOR IN 
(SELECT F.ID_FURNIZOR FROM FURNIZORI F JOIN COMENZI CM ON F.ID_FURNIZOR=CM.ID_FURNIZOR
 WHERE CM.ID_CLIENT IN (SELECT ID_CLIENT FROM CLIENTI C JOIN REGIUNI R ON C.ID_REGIUNE=R.ID_REGIUNE
 WHERE UPPER(DENUMIRE_REGIUNE) LIKE 'BRASOV'));

SELECT ID_CLIENT FROM CLIENTI C JOIN REGIUNI R ON C.ID_REGIUNE=R.ID_REGIUNE
WHERE UPPER(DENUMIRE_REGIUNE) LIKE 'BRASOV';

--10 SA SE ADAUGE NR DE TELEFON 0248526044 CLIENTULUI DIN REGIUNEA BRASOV
UPDATE CLIENTI SET TELEFON='0248526044' WHERE ID_CLIENT IN 
(SELECT ID_CLIENT FROM CLIENTI C JOIN REGIUNI R ON C.ID_REGIUNE=R.ID_REGIUNE
 WHERE UPPER(DENUMIRE_REGIUNE) LIKE 'BRASOV');
 
--11 SA SE AFISEZE REGIUNILE CARE NU AU A DOUA LITERA 'A'
SELECT * FROM REGIUNI WHERE SUBSTR(UPPER(DENUMIRE_REGIUNE),2,1)!='A';

SELECT * FROM REGIUNI WHERE SUBSTR(UPPER(DENUMIRE_REGIUNE),3,1)='A';

--12 SA SE AFISEZE CLIENTII SI NUMERELE DE TELEFON ALE ACESTORA
SELECT NUME_CLIENT, PRENUME_CLIENT, NVL(TELEFON,'-') FROM CLIENTI;

--13 SA SE CREEZE O TABELA VIRTUALA CARE SA CONTINA VALOAREA TOTALA A FIECAREI COMENZI
CREATE OR REPLACE VIEW VIEW_VAL_COMENZI AS
SELECT ID_COMANDA, SUM(PRET_TOTAL) VAL FROM TRANSPORTURI
GROUP BY ID_COMANDA;

SELECT * FROM VIEW_VAL_COMENZI;

--14 SA SE AFISEZE VALOAREA TOTALA A COMENZILOR CLIENTULUI DIN ARAD
SELECT SUM(VAL) FROM VIEW_VAL_COMENZI WHERE ID_COMANDA IN
(SELECT ID_COMANDA FROM COMENZI WHERE ID_CLIENT IN 
(SELECT ID_CLIENT FROM CLIENTI C JOIN REGIUNI R ON C.ID_REGIUNE=R.ID_REGIUNE
WHERE UPPER(DENUMIRE_REGIUNE) LIKE 'ARAD'));

--15 SA SE CREEZE O TABELA VIRTUALA CARE SA CONTINA VALOAREA TOTALA A FIECAREI COMENZI SI CANTITATEA CORESPUNZATOARE
CREATE OR REPLACE VIEW TABEL_COMENZI AS
SELECT ID_COMANDA, SUM(PRET_TOTAL) VALOARE, SUM(CANTITATE) CANTITATE FROM TRANSPORTURI
GROUP BY ID_COMANDA;

SELECT * FROM TABEL_COMENZI;

--16 SA SE AFISEZE COMENZILE CARE AU CANTITATEA COMANDATA CUPRINSA INTRE 10 SI 100 
--FARA COMENZILE CARE AU VALOAREA CUPRINSA INTRE 7000 SI 7500
SELECT * FROM TABEL_COMENZI WHERE CANTITATE BETWEEN 10 AND 100
MINUS
SELECT * FROM TABEL_COMENZI WHERE VALOARE BETWEEN 7000 AND 7500;

--17 SA SE AFISEZE DENUMIREA SORTIMENTULUI DE LEMN, VALOAREA TOTALA COMANDATA PENTRU SORTIMENTELE
--COMANDATE DE CEL PUTIN 2 ORI SI CARE AU VALOAREA TOTALA DIFERITA DE 20000
SELECT L.DENUMIRE_LEMN, SUM(T.PRET_TOTAL) VALOARE FROM SORTIMENTE_LEMN L JOIN TRANSPORTURI T
ON L.ID_LEMN=T.ID_LEMN GROUP BY L.DENUMIRE_LEMN HAVING COUNT(T.ID_COMANDA)>=2
INTERSECT
SELECT L.DENUMIRE_LEMN, SUM(T.PRET_TOTAL) VALOARE FROM SORTIMENTE_LEMN L JOIN TRANSPORTURI T
ON L.ID_LEMN=T.ID_LEMN GROUP BY L.DENUMIRE_LEMN HAVING SUM(T.PRET_TOTAL) != 20000;

--18 SA SE AFISEZE CE PRET AR AVEA SORTIMENTELE DE LEMNE CARE PROVIN DIN IALOMITA SI ARGES
--DACA PRETUL CURENT S-AR MAJORA CU 10% RESPECTIV 15%
SELECT ID_LEMN, DENUMIRE_LEMN, PRET, 1.1*PRET PRET_NOU FROM SORTIMENTE_LEMN
WHERE ID_REGIUNE IN (SELECT ID_REGIUNE FROM REGIUNI WHERE UPPER(DENUMIRE_REGIUNE) LIKE 'IALOMITA')
UNION
SELECT ID_LEMN, DENUMIRE_LEMN, PRET, 1.15*PRET PRET_NOU FROM SORTIMENTE_LEMN
WHERE ID_REGIUNE IN (SELECT ID_REGIUNE FROM REGIUNI WHERE UPPER(DENUMIRE_REGIUNE) LIKE 'ARGES');





SELECT * FROM COMENZI;
SELECT * FROM REGIUNI;
SELECT * FROM SORTIMENTE_LEMN;
SELECT * FROM TRANSPORTURI;
SELECT * FROM FURNIZORI;
SELECT * FROM CLIENTI;






